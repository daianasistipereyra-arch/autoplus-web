<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AutoPlus - Venta de Vehículos</title>
  <script src="https://kit.fontawesome.com/a2e0e6ad53.js" crossorigin="anonymous"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-900">

  <!-- Encabezado -->
  <header class="bg-white shadow-md">
    <div class="container mx-auto px-4 py-4 flex justify-between items-center">
      <div class="flex items-center space-x-2">
        <img src="img/logo.png" alt="AutoPlus" class="h-12">
        <h1 class="text-2xl font-bold">AutoPlus</h1>
      </div>
      <nav class="space-x-4 flex items-center">
        <a href="#vehiculos" class="hover:text-blue-500">Vehículos</a>
        <a href="#inspeccion" class="hover:text-blue-500">Inspección</a>
        <a href="#contacto" class="hover:text-blue-500">Contacto</a>
        <button onclick="accederAdmin()" title="Acceso administrador" class="text-blue-600 text-2xl font-bold hover:text-blue-800">+</button>
      </nav>
    </div>
  </header>

  <!-- Vehículos Disponibles -->
  <section id="vehiculos" class="py-16 px-4">
    <div class="container mx-auto max-w-6xl">
      <h2 class="text-3xl font-bold text-center mb-8">Vehículos Disponibles</h2>
      <div class="mb-6 flex justify-center">
        <input 
          type="text" 
          id="buscador" 
          placeholder="Buscar por marca o modelo..." 
          class="w-full md:w-1/2 border p-2 rounded-lg shadow-sm"
          onkeyup="filtrarVehiculos()"
        >
      </div>
      <div id="vehiculos-lista" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6"></div>
    </div>
  </section>

  <!-- Servicio de Inspección Mecánica -->
  <section id="inspeccion" class="py-16 px-4 bg-white">
    <div class="container mx-auto max-w-4xl text-center">
      <h2 class="text-3xl font-bold mb-6">Servicio de Inspección Mecánica</h2>
      <p class="text-lg text-gray-700 leading-relaxed mb-6">
        Ofrecemos una <strong>revisión detallada de vehículos</strong> para verificar que todos sus 
        componentes vitales estén en óptimas condiciones de funcionamiento. 
      </p>
      <ul class="text-left space-y-2 text-gray-800 mb-6">
        <li>✔️ Motor</li>
        <li>✔️ Transmisión</li>
        <li>✔️ Frenos</li>
        <li>✔️ Suspensión</li>
        <li>✔️ Dirección</li>
      </ul>
      <p class="text-lg text-gray-700 leading-relaxed">
        Nuestro objetivo es <strong>prevenir averías</strong>, garantizar la 
        <strong>seguridad del conductor</strong> y prolongar la <strong>vida útil del automóvil</strong>, 
        asegurando que cumpla con los estándares de seguridad y del fabricante.
      </p>
    </div>
  </section>

  <!-- Contacto -->
  <section id="contacto" class="py-16 px-4 bg-gray-50">
    <div class="container mx-auto max-w-4xl text-center">
      <h2 class="text-3xl font-bold mb-6">Contacto</h2>
      <p class="mb-4">¿Interesado en alguno de nuestros vehículos o en una inspección mecánica? ¡Escribinos!</p>
      <ul class="space-y-2 text-lg">
        <li><i class="fas fa-phone mr-2"></i> <a href="tel:2615530879">2615530879</a></li>
        <li><i class="fab fa-whatsapp mr-2"></i> <a href="https://wa.me/2615530879" target="_blank">WhatsApp</a></li>
        <li><i class="fas fa-envelope mr-2"></i> <a href="mailto:autos.premiumplus@gmail.com">autos.premiumplus@gmail.com</a></li>
      </ul>
    </div>
  </section>

  <!-- Panel de Administración -->
  <section id="admin" class="py-16 px-4 bg-gray-50 hidden">
    <div class="container mx-auto max-w-4xl">
      <h2 class="text-3xl font-bold text-center mb-8">Panel de Administración</h2>

      <form id="formularioVehiculos" class="space-y-4 bg-white p-6 rounded shadow-md">
        <div>
          <label class="block mb-1 font-semibold">Marca</label>
          <input type="text" id="marca" class="w-full border p-2 rounded" required>
        </div>
        <div>
          <label class="block mb-1 font-semibold">Modelo</label>
          <input type="text" id="modelo" class="w-full border p-2 rounded" required>
        </div>
        <div>
          <label class="block mb-1 font-semibold">Año</label>
          <input type="number" id="anio" class="w-full border p-2 rounded" required>
        </div>
        <div class="flex gap-2">
          <div class="flex-1">
            <label class="block mb-1 font-semibold">Precio</label>
            <input type="number" id="precio" class="w-full border p-2 rounded" required>
          </div>
          <div class="flex-1">
            <label class="block mb-1 font-semibold">Moneda</label>
            <select id="moneda" class="w-full border p-2 rounded">
              <option value="USD">USD</option>
              <option value="ARS">ARS</option>
            </select>
          </div>
        </div>
        <div>
          <label class="block mb-1 font-semibold">Imágenes</label>
          <input type="file" id="imagenes" class="w-full border p-2 rounded" accept="image/*" multiple>
          <small class="text-gray-500">Dejar vacío para mantener imágenes actuales</small>
        </div>
        <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Guardar Vehículo</button>
      </form>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-white py-4 text-center text-gray-600">
    <p>&copy; 2025 AutoPlus - Todos los derechos reservados</p>
  </footer>

  <script>
    let isAdmin = false; // controla permisos de administrador
    const formulario = document.getElementById('formularioVehiculos');
    const listaVehiculos = document.getElementById('vehiculos-lista');
    let vehiculos = JSON.parse(localStorage.getItem('vehiculos')) || [];

    // Acceso administrador
    function accederAdmin() {
      const clave = prompt("Ingrese la clave de administrador:");
      if (clave === "Auto2025*") {
        isAdmin = true;
        document.getElementById("admin").classList.remove("hidden");
        window.location.hash = "#admin";
        listaVehiculos.innerHTML = '';
        vehiculos.forEach(auto => mostrarVehiculo(auto));
      } else if (clave !== null) {
        alert("Clave incorrecta.");
      }
    }

    // Función para mostrar vehículos
    function mostrarVehiculo(auto) {
      const index = vehiculos.indexOf(auto);
      const idCarrusel = `carrusel-${Date.now()}-${Math.floor(Math.random()*1000)}`;

      const autoHTML = document.createElement('div');
      autoHTML.className = 'bg-white shadow-md rounded overflow-hidden';

      autoHTML.innerHTML = `
        <div class="relative">
          <img src="${auto.imagenes[0]}" alt="${auto.marca} ${auto.modelo}" class="w-full h-48 object-cover rounded-t">
          ${auto.imagenes.length > 1 ? `
          <button class="absolute left-2 top-1/2 -translate-y-1/2 bg-white bg-opacity-70 p-1 rounded" onclick="anterior('${idCarrusel}')">
            <i class="fas fa-chevron-left"></i>
          </button>
          <button class="absolute right-2 top-1/2 -translate-y-1/2 bg-white bg-opacity-70 p-1 rounded" onclick="siguiente('${idCarrusel}')">
            <i class="fas fa-chevron-right"></i>
          </button>` : ''}
        </div>
        <div class="p-4">
          <h3 class="font-bold text-xl">${auto.marca} ${auto.modelo}</h3>
          <p>Año: ${auto.anio}</p>
          <p>Precio: ${auto.precio} ${auto.moneda}</p>
          ${isAdmin ? `
          <div class="flex justify-end gap-2 mt-2">
            <button class="bg-yellow-400 text-white px-2 py-1 rounded hover:bg-yellow-500" onclick="editarVehiculo(${index})">Editar</button>
            <button class="bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700" onclick="borrarVehiculo(${index})">Borrar</button>
          </div>` : ''}
        </div>
      `;

      autoHTML.dataset.imagenes = JSON.stringify(auto.imagenes);
      autoHTML.dataset.pos = 0;
      autoHTML.id = idCarrusel;
      listaVehiculos.appendChild(autoHTML);
    }

    // Carrusel de imágenes
    function siguiente(id) {
      const carrusel = document.getElementById(id);
      let pos = parseInt(carrusel.dataset.pos);
      const imgs = JSON.parse(carrusel.dataset.imagenes);
      pos = (pos + 1) % imgs.length;
      carrusel.querySelector('img').src = imgs[pos];
      carrusel.dataset.pos = pos;
    }

    function anterior(id) {
      const carrusel = document.getElementById(id);
      let pos = parseInt(carrusel.dataset.pos);
      const imgs = JSON.parse(carrusel.dataset.imagenes);
      pos = (pos - 1 + imgs.length) % imgs.length;
      carrusel.querySelector('img').src = imgs[pos];
      carrusel.dataset.pos = pos;
    }

    // Buscador
    function filtrarVehiculos() {
      const filtro = document.getElementById('buscador').value.toLowerCase();
      const autos = listaVehiculos.children;
      Array.from(autos).forEach(auto => {
        const texto = auto.textContent.toLowerCase();
        auto.style.display = texto.includes(filtro) ? '' : 'none';
      });
    }

    // Función para agregar vehículo
    function agregarVehiculo(index = null) {
      const marca = document.getElementById('marca').value;
      const modelo = document.getElementById('modelo').value;
      const anio = document.getElementById('anio').value;
      const precio = document.getElementById('precio').value;
      const moneda = document.getElementById('moneda').value;
      const files = document.getElementById('imagenes').files;

      const readerPromises = Array.from(files).map(file => {
        return new Promise(resolve => {
          const reader = new FileReader();
          reader.onload = () => resolve(reader.result);
          reader.readAsDataURL(file);
        });
      });

      Promise.all(readerPromises).then(imagenesBase64 => {
        let nuevoAuto = { 
          marca, modelo, anio, precio, moneda, 
          imagenes: index !== null && files.length === 0 ? vehiculos[index].imagenes : imagenesBase64 
        };
        if (index === null) {
          vehiculos.push(nuevoAuto);
        } else {
          vehiculos[index] = nuevoAuto;
        }
        localStorage.setItem('vehiculos', JSON.stringify(vehiculos));
        listaVehiculos.innerHTML = '';
        vehiculos.forEach(auto => mostrarVehiculo(auto));
        formulario.reset();
      });
    }

    // Listener general para agregar vehículo
    function manejarSubmit(e) {
      e.preventDefault();
      agregarVehiculo();
    }
    formulario.addEventListener('submit', manejarSubmit);

    // Editar vehículo
    function editarVehiculo(index) {
      const auto = vehiculos[index];
      document.getElementById('marca').value = auto.marca;
      document.getElementById('modelo').value = auto.modelo;
      document.getElementById('anio').value = auto.anio;
      document.getElementById('precio').value = auto.precio;
      document.getElementById('moneda').value = auto.moneda;

      // Remover temporalmente listener de agregar
      formulario.removeEventListener('submit', manejarSubmit);

      formulario.addEventListener('submit', function actualizar(e) {
        e.preventDefault();
        agregarVehiculo(index);
        formulario.removeEventListener('submit', actualizar);
        formulario.addEventListener('submit', manejarSubmit);
      });
    }

    // Borrar vehículo
    function borrarVehiculo(index) {
      if (confirm("¿Desea eliminar este vehículo?")) {
        vehiculos.splice(index, 1);
        localStorage.setItem('vehiculos', JSON.stringify(vehiculos));
        listaVehiculos.innerHTML = '';
        vehiculos.forEach(auto => mostrarVehiculo(auto));
      }
    }

    // Inicializar lista de vehículos al cargar la página
    vehiculos.forEach(auto => mostrarVehiculo(auto));

  </script>

</body>
</html>